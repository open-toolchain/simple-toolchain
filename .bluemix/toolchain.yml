version: '2'
default_locale: en
locales:
  $ref: locales.yml
template:
  name: Simple Cloud Foundry toolchain
  description: >-
    With this toolchain, you can develop and deploy a Cloud Foundry application.
    By default, the toolchain uses a sample Node.js "Hello World" app, or you
    can link to your own GitHub repository. This toolchain is preconfigured for
    continuous delivery, source control, issue tracking, and online editing.


    To get started, click **Create**.
  header: '![](toolchain.png "header image")'
  required:
    - sample-build
    - sample-repo
  info:
    git url: >-
      [https://github.com/open-toolchain/simple-toolchain](https://github.com/open-toolchain/simple-toolchain)
    git branch: >-
      [dedicated-no-ghe](https://github.com/open-toolchain/simple-toolchain/tree/dedicated-no-ghe)
toolchain:
  name: 'simple-toolchain-{{timestamp}}'
services:
  sample-repo:
    service_id: githubpublic
    parameters:
      repo_name: '{{toolchain.name}}'
      repo_url: 'https://github.com/open-toolchain/node-hello-world'
      type: clone
      has_issues: true
  sample-build:
    service_id: pipeline
    parameters:
      services:
        - sample-repo
      name: '{{toolchain.name}}'
      ui-pipeline: true
      configuration:
        content: $file(pipeline.yml)
        env:
          SAMPLE_REPO: sample-repo
          CF_APP_NAME: '{{form.pipeline.parameters.prod-app-name}}'
          PROD_SPACE_NAME: '{{form.pipeline.parameters.prod-space}}'
          PROD_ORG_NAME: '{{form.pipeline.parameters.prod-organization}}'
          PROD_REGION_ID: '{{form.pipeline.parameters.prod-region}}'
        execute: true
  webide:
    service_id: orion
form:
  pipeline:
    parameters:
      prod-app-name: '{{services.sample-repo.parameters.repo_name}}'
    schema:
      $ref: deploy.json
